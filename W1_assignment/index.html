<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>W1_assignment</title>
</head>
<body>
    <header>
        <nav>
            <a href="about.html">About</a>
        </nav>
        <h1>FetchAPI_assignment</h1>
        <button id="startButton">Start here(Wait 30sâ€“1min)</button>
    </header>
    <main>
        <div id="main-content"></div>
    </main>
    <script>
        const triggerButton = document.getElementById("startButton")
        const mainContent = document.getElementById("main-content")

        const randomId = Math.floor(Math.random() * 1301)
        let autoPokemonName = null

        const fetchPokemonData = () =>{
            fetch(`https://pokeapi.co/api/v2/pokemon/${randomId}`)
                .then((response) => response.json())
                .then((data) => appendPokemonData(data))
        }

        const fetchPokemontcgData = (uppercaseAutoPokemonName) => {   
            fetch(`https://api.pokemontcg.io/v2/cards?q=name:${uppercaseAutoPokemonName}`)
                .then((response) => response.json())
                .then((data) => appendPokemontcgData(data, uppercaseAutoPokemonName))
        }

        const appendPokemonData = (data) =>{
            console.log(data)

            const pokemonName = data.name
            const pokemonFrontImage = data.sprites.front_default
            const pokemonBackImage = data.sprites.back_default

            autoPokemonName = pokemonName
                    
            let pokemanHTML =`
            <h2>Spirit's name: ${pokemonName}</h2>
            <img src="${pokemonFrontImage}" alt="Front image of ${pokemonName}"/>
            <img src="${pokemonBackImage}" alt="Back image of ${pokemonName}"/>
            `
            mainContent.innerHTML = pokemanHTML
            
            const uppercaseAutoPokemonName = autoPokemonName.charAt(0).toUpperCase() + autoPokemonName.slice(1)
            fetchPokemontcgData(uppercaseAutoPokemonName)
        }

        const appendPokemontcgData = (data, uppercaseAutoPokemonName) => {
            let pokemontcgData = data.data[0]
            console.log(pokemontcgData)

            const cardID = pokemontcgData.id
            const cardIMG = pokemontcgData.images.small
            console.log(uppercaseAutoPokemonName)

            let pokemontcgHTML = `
            <h3>Card ID: ${cardID}</h3>
            <img src="${cardIMG}" alt="${uppercaseAutoPokemonName}"/>
            `
            mainContent.innerHTML += pokemontcgHTML
        }

        triggerButton.addEventListener('click', fetchPokemonData)
    </script>
</body>
</html>